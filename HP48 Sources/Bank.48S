LIBRARY 1112 "BANK Gestion de compte simple"@ ***********************************************************************@ * Cette librairie permet la gestion simple d'un compte bancaire.	*@ * Elle est appelée par la fonction BANK				*@ ***********************************************************************COMMANDS  BANK AboutBANKLOCAL  ErrorBANK  DepotBANK RetraitBANK ListeBANK SuivantBANK OperBANK@ ***********************************************************************@ * Objet de configuration : Auto ATTACH et message d'accueil		*@ ***********************************************************************CONFIG  PROG    1112 ATTACH    CLLCD    "BANK 2.0 Ok" 3 DISP    0.2 WAIT  ENDMESSAGES  [ "Invalid BANKDAT" ]@ ***********************************************************************@ *	Contenu de la librairie						*@ ***********************************************************************CONTENT@ Message d'information simple  AboutBANK    PROG"  Gestion simple de   Compte Bancaire  Ecrit en 1992 parChristophe de DINECHIN      FREEWARE"      1 DISP      7 FREEZE    END@ ***********************************************************************@ *			Programme principal				*@ ***********************************************************************  BANK    PROG      EXTERNAL #18A1Eh		@ Begin Command      CLLCD      IF BANKDAT 'BANKDAT' SAME THEN        { { 0 "Compte Inconnu" } } 'BANKDAT' STO        "BANKDAT Created" 1 DISP      END      IF BANKDAT TYPE 5 <> THEN        ErrorBANK      END      0 RCLF RCLMENU -> Key Flags Menu      <<        @ 2 Fixed digits, no clock display, french date format        2 FIX -40 CF -42 SF -41 SF        DO          { "Depot" "Retrait" "Suivant" "Liste" "" "Fin"} TMENU          "Compte:" BANKDAT 1 GET 2 GET +        2 DISP          "Solde:"  BANKDAT 1 GET 1 GET +        3 DISP          "Nombre de comptes:" BANKDAT SIZE +    4 DISP          -1 WAIT 'Key' STO          CLLCD          CASE            Key 11.1 == THEN DepotBANK END            Key 12.1 == THEN RetraitBANK END            Key 13.1 == THEN SuivantBANK END            Key 14.1 == THEN ListeBANK END            Key 16.1 == THEN END            400 0.1 BEEP          END          CLLCD        UNTIL Key 16.1 == END        Flags STOF        "Au revoir ..." 1 DISP 7 FREEZE        Menu MENU      >>    END  ErrorBANK    PROG      #45801h DOERR    END  DepotBANK    PROG      1 "depot:" OperBANK    END  RetraitBANK    PROG      -1 "retrait:" OperBANK    END  OperBANK    PROG      BANKDAT 1 GET {0 0 0}      -> Signe Operation Compte Courant      <<        "Somme du " Operation + "" INPUT STR-> Signe *        DUP Compte 1 GET + 'Compte' 1 ROT PUT        'Courant' 1 ROT PUT        "Motif du " Operation + { "" EXTERNAL #4358Ah } INPUT        'Courant' 2 ROT PUT        5.121968 DATE DDAYS 24 * TIME + 'Courant' 3 ROT PUT        Compte 1 2 SUB          0 +          Compte 3 OVER SIZE SUB +          3 Courant PUT        'BANKDAT' 1 ROT PUT      >>    END  ListeBANK    PROG      0 3 BANKDAT 1 GET -> Key Pos Compte      <<        DO          { "Suivant" "Precedent" "Effacer" "" "" "Fin" } TMENU          "Releve d'operation:" 1 DISP          IF Compte SIZE 3 >= THEN            Compte Pos GET LIST->            IF 3 <> THEN ErrorBANK END            DUP 24 / IP 5.121968 SWAP DATE+            SWAP 24 MOD            TSTR 5 DISP            4 DISP            IF DUP 0 >= THEN              "Depot:"            ELSE              "Retrait:"            END            SWAP ABS + 3 DISP            -1 WAIT 'Key' STO            CASE              Key 11.1 == THEN                 1 Pos + Compte SIZE MIN 'Pos' STO              END              Key 12.1 == THEN                Pos 1 - 3 MAX 'Pos' STO              END              Key 13.1 == THEN                "Effacement" 1 DISP                Compte 1 Pos 1 - SUB Compte Pos 1 + OVER SIZE SUB +                'Compte' STO                IF Pos Compte SIZE > THEN                  Compte SIZE 'Pos' STO                END              END              Key 16.1 == THEN                "Termine" 6 DISP              END              400 0.1 BEEP            END          ELSE            16.1 'Key' STO          END        UNTIL Key 16.1 == END        'BANKDAT' 1 Compte PUT      >>    END  SuivantBANK    PROG      BANKDAT 2 OVER SIZE SUB BANKDAT 1 1 SUB + 'BANKDAT' STO    ENDEND